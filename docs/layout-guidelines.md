# PandaHabit 布局规范指南

## 目标

本文档旨在提供一套统一的布局规范，以确保PandaHabit应用中所有页面具有一致的布局结构，解决当前布局混乱的问题，并提高用户体验。本规范参考了[苹果游戏设计指南](https://developer.apple.com/design/human-interface-guidelines/designing-for-games)的核心原则，结合了华丽游戏风格的特点。

## 1. 游戏设计核心原则

参考苹果游戏设计指南，我们采用以下核心原则：

### 1.1 专注于核心游戏体验

- **简化界面**：减少不必要的UI元素，让用户专注于核心游戏体验
- **直观交互**：确保交互方式直观且符合用户预期
- **视觉层次**：建立清晰的视觉层次，突出重要元素
- **一致性**：保持界面元素和交互方式的一致性

### 1.1.1 iOS游戏设计特有原则

- **设备适应性**：考虑用户可能在旅行、办公桌前、沙发上或站立时玩游戏
- **硬件利用**：充分利用高分辨率显示屏、Apple芯片性能和触控功能
- **触控优先**：iPhone和iPad游戏应以触控为主要交互方式
- **物理反馈**：使用触觉反馈匹配游戏中的重要事件
- **环境适应**：考虑用户所处环境（明亮、黑暗、嘈杂、安静）对游戏体验的影响

### 1.2 安全区域与布局

遵循苹果设备的安全区域指南：

- **边缘安全区域**：确保重要内容和交互元素不被设备边缘、刘海或动态岛遮挡
- **底部安全区域**：为底部手势预留足够空间（至少44pt）
- **顶部安全区域**：为状态栏和刘海区域预留空间

### 1.3 间距规范

为确保视觉一致性，应使用以下标准间距：

- **紧凑间距**：8pt（适用于相关元素之间）
- **标准间距**：16pt（适用于组件内部元素）
- **宽松间距**：24pt（适用于主要内容区块之间）
- **分隔间距**：32pt（适用于不同功能区域之间）

所有元素间距应使用这些标准值的倍数，不应使用任意值。

### 1.4 对齐原则

- **网格对齐**：所有元素应遵循基础网格对齐
- **边缘对齐**：相关元素应共享同一边缘
- **中心对齐**：强调元素可使用中心对齐
- **一致性**：保持整个应用中的对齐一致性

### 1.5 响应式设计

优先考虑以下设备和方向：

- **iPhone**：垂直方向（375pt × 667pt 至 428pt × 926pt）
- **iPad**：垂直和水平方向（768pt × 1024pt 至 1024pt × 1366pt）

确保UI在所有支持的设备和方向上都能正确显示和交互。

## 2. 游戏界面结构规范

### 2.1 游戏界面层次

根据苹果游戏设计指南，我们将界面分为以下层次：

1. **游戏世界层**：展示熊猫和主要游戏环境
2. **HUD层**：显示资源、状态和关键信息
3. **交互层**：提供主要交互按钮和控件
4. **菜单层**：提供导航和设置选项
5. **弹出层**：显示临时信息和交互

### 2.2 屏幕布局区域

将屏幕划分为以下功能区域：

```
+----------------------------------+
|        状态区（资源显示）        |
+----------------------------------+
|                                  |
|        主要内容/游戏区域         |
|        (熊猫互动/任务展示)       |
|                                  |
+----------------------------------+
|          主要交互区域            |
+----------------------------------+
|            导航区域              |
+----------------------------------+
```

### 2.3 内容区域布局模式

根据功能需求，选择以下布局模式之一：

1. **焦点模式**：突出单个主要元素（如熊猫展示）
2. **卡片流模式**：适用于任务列表、成就展示等
3. **网格模式**：适用于皮肤选择、能力展示等
4. **分屏模式**：适用于需要对比或并列显示的内容
5. **沉浸模式**：适用于反思、心情记录等需要专注的功能

### 2.4 导航与交互

遵循苹果游戏设计指南的导航原则：

- **主导航**：使用底部标签栏，包含3-5个主要功能区域
- **返回导航**：提供明确的返回路径，位于左上角
- **手势导航**：支持标准手势（滑动、点击、拖拽）
- **上下文导航**：在适当位置提供上下文相关的导航选项
- **分层导航**：主要功能→子功能→详情的清晰层次

#### 2.4.1 iOS直观交互体验

根据苹果iOS设计指南，提供直观的交互体验：

- **默认交互方法**：支持iPhone和iPad的默认交互方式（触控）
- **触控设计**：围绕点击、滑动、手势、平移、绘制路径等设计游戏
- **物理反馈**：使用触觉反馈匹配游戏中的重要事件
- **辅助输入**：支持游戏控制器作为可选输入方式
- **无障碍交互**：确保所有交互可通过多种方式完成，支持辅助功能

## 3. 游戏UI组件规范

### 3.1 游戏卡片组件

参考苹果游戏设计指南中的卡片设计：

- 使用圆角设计（16pt），符合iOS设计语言
- 卡片内边距为16pt，保持一致的呼吸空间
- 卡片之间的间距为16pt（垂直）或12pt（水平）
- 使用层次感设计，通过阴影或描边区分前景和背景
- 卡片内容结构：

```
+----------------------------------+
|            卡片标题              |
+----------------------------------+
|                                  |
|            卡片内容              |
|                                  |
+----------------------------------+
|            卡片操作              |
+----------------------------------+
```

### 3.2 游戏列表项组件

- 列表项高度应根据内容类型保持一致（60pt、80pt或100pt）
- 使用16pt的内边距，确保内容不会过于拥挤
- 列表项之间使用视觉分隔（8pt间距或1pt分隔线）
- 支持滑动操作（如完成任务、删除等）
- 列表项内容结构：

```
+-------+-------------------------+-------+
| 图标/ |     主要内容/标题       | 状态/ |
| 头像  |     次要内容/描述       | 操作  |
+-------+-------------------------+-------+
```

### 3.3 游戏控件组件

遵循苹果游戏设计指南中的控件设计原则：

- **按钮**：
  - 最小点击区域为44pt×44pt
  - 使用视觉反馈指示可点击状态
  - 提供按下状态的明确反馈
  - 使用一致的视觉语言（如印章风格）

- **输入控件**：
  - 输入区域高度至少为44pt
  - 标签位于输入框上方，间距为8pt
  - 错误提示位于输入框下方，使用醒目颜色
  - 使用适合游戏风格的自定义输入控件（如卷轴式输入）

- **滑块和开关**：
  - 使用自定义设计，符合游戏风格
  - 保持功能与标准控件一致
  - 提供清晰的视觉和触觉反馈

### 3.4 游戏弹窗组件

根据苹果游戏设计指南中的弹窗设计：

- 使用传统窗棂样式，符合游戏主题
- 弹窗居中显示，背景半透明遮罩
- 弹窗宽度为屏幕宽度的85%（不超过400pt）
- 内边距为24pt，确保内容有足够呼吸空间
- 标题使用游戏风格字体，居中对齐
- 按钮使用游戏风格设计，水平排列
- 支持手势关闭（下滑或点击外部）

## 4. 特定游戏页面布局规范

### 4.1 主页/家园（焦点模式）

参考苹果游戏设计指南中的主屏幕设计：

- **游戏世界层**：熊猫展示区域占据屏幕中央60-70%的区域
- **HUD层**：
  - 资源显示位于顶部安全区域内，采用水平排列
  - 使用图标+数值的组合，确保清晰可读
- **交互层**：
  - 主要互动按钮围绕熊猫展示区域排列，形成环形或半环形布局
  - 每个按钮至少44pt×44pt，间距至少16pt
- **状态层**：
  - 任务进度显示在底部导航栏上方
  - 使用视觉指示器显示当前状态

### 4.2 任务列表页（卡片流模式）

- **导航区**：
  - 页面标题和返回按钮位于顶部安全区域
  - 筛选器位于标题下方，采用水平滚动卡片式设计
- **内容区**：
  - 任务列表采用垂直滚动的卡片流布局
  - 每个任务卡片高度一致，间距为16pt
  - 任务卡片包含图标、名称、描述、截止日期和状态指示器
- **交互区**：
  - 添加任务按钮固定在右下角，距离边缘16pt，直径至少60pt
  - 支持滑动手势完成或编辑任务

### 4.3 熊猫互动/详情页（分屏模式）

- **上半部分**：
  - 熊猫展示区域占据屏幕上半部分（约60%）
  - 使用3D效果和动画增强沉浸感
  - 互动按钮围绕熊猫排列，使用图标+文字组合
- **下半部分**：
  - 标签页导航位于分界线处，使用水平滑动切换
  - 详情内容采用卡片布局，支持垂直滚动
  - 每个标签页内容保持一致的视觉风格

### 4.4 心情打卡/反思模块（沉浸模式）

- **顶部区域**：
  - 心情选择器采用水平排列的大图标设计
  - 每个心情图标至少60pt×60pt，间距16pt
  - 当前选中状态有明确视觉反馈
- **中部区域**：
  - 反思输入区域采用卷轴或古籍设计
  - 输入框高度自适应，最小高度120pt
  - 提供字数统计和提示信息
- **底部区域**：
  - 历史记录采用时间线布局，支持水平滑动查看
  - 提交按钮位于输入区域下方，宽度至少200pt

### 4.5 个人资料/设置页（网格模式）

- **顶部区域**：
  - 用户信息卡片占据屏幕宽度的90%
  - 包含头像、用户名、等级和简介
  - 使用游戏风格装饰元素增强视觉效果
- **中部区域**：
  - 统计数据采用2×2或3×2网格布局
  - 每个统计项使用图标+数值+标签组合
  - 网格间距为16pt，内边距为16pt
- **底部区域**：
  - 成就展示采用水平滚动卡片布局，每页显示2-3个
  - 设置项采用分组列表布局，组间距为24pt
  - 每个设置项高度至少60pt，包含图标、标题和控件

## 5. 游戏UI实现指南

### 5.1 游戏UI设计原则

根据苹果游戏设计指南，实现时应遵循以下原则：

- **直观性**：用户应能立即理解界面元素的功能
- **一致性**：保持视觉语言和交互模式的一致
- **反馈**：为每个交互提供明确的视觉和触觉反馈
- **可发现性**：重要功能应易于发现，不应隐藏在复杂手势后
- **可访问性**：确保所有用户都能使用游戏功能

### 5.1.1 iOS特有设计考量

根据苹果iOS设计指南，特别注意以下方面：

- **触控优化**：所有交互元素设计为触控友好
- **手势一致性**：使用iOS标准手势，避免创造新手势
- **安全区域**：尊重刘海、动态岛等设备特性的安全区域
- **自适应布局**：适应不同iPhone尺寸（从SE到Pro Max）
- **深色模式**：支持浅色和深色模式
- **动态字体**：支持iOS动态字体大小调整
- **本地化**：支持从左到右和从右到左的语言布局

### 5.2 CSS实现规范

采用BEM（Block, Element, Modifier）命名规范，结合游戏UI特点：

- **Block**：独立组件，如`.game-card`、`.task-list`
- **Element**：组件的一部分，如`.game-card__title`、`.task-list__item`
- **Modifier**：组件的变体，如`.game-card--legendary`、`.task-list__item--completed`

### 5.3 游戏UI工具类

创建以下游戏UI工具类简化实现：

- **间距类**：`.game-spacing-{size}`（8pt, 16pt, 24pt, 32pt）
- **层次类**：`.game-layer-{level}`（world, hud, interaction, menu, popup）
- **动画类**：`.game-animation-{type}`（fade, bounce, reveal, ink-spread）
- **装饰类**：`.game-decoration-{style}`（scroll, ink, bamboo, traditional）

### 5.4 响应式游戏UI实现

- 使用安全区域变量（`safe-area-inset-*`）确保内容不被设备特性遮挡
- 优先使用相对单位（%, rem）和视口单位（vh, vw）
- 关键交互元素使用固定尺寸（pt）确保可点击性
- 使用CSS Grid和Flexbox创建灵活布局
- 为不同设备方向提供优化布局

### 5.5 游戏性能优化

- 使用CSS硬件加速属性（transform, opacity）实现流畅动画
- 避免过度使用阴影、模糊等高耗性能的CSS属性
- 使用CSS变量管理主题和动态样式变化
- 大型动画效果使用sprite sheets或lottie动画
- 考虑低性能设备的降级方案

## 6. 游戏UI检查清单

在完成页面实现后，使用以下清单进行检查：

### 6.1 基础检查项

- [ ] 界面是否遵循游戏层次结构？（世界层、HUD层、交互层等）
- [ ] 所有交互元素是否有足够大的点击区域？（至少44pt×44pt）
- [ ] 内容是否位于安全区域内？（避免刘海、动态岛等遮挡）
- [ ] 是否为所有交互提供了明确的视觉反馈？
- [ ] 界面在所有支持的设备和方向上是否正确显示？
- [ ] 动画是否流畅且不影响性能？
- [ ] 是否保持了一致的视觉语言和游戏风格？
- [ ] 是否考虑了可访问性需求？
- [ ] 是否遵循了特定页面的布局规范？
- [ ] 是否使用了游戏UI工具类简化实现？

### 6.2 iOS特有检查项

- [ ] 是否遵循iOS人机界面指南？
- [ ] 触控区域是否符合iOS标准（至少44pt×44pt）？
- [ ] 是否支持iOS系统手势（如返回手势）？
- [ ] 是否适配所有目标iPhone屏幕尺寸？
- [ ] 是否支持iOS深色模式？
- [ ] 是否支持动态字体大小？
- [ ] 是否考虑了单手操作的便利性？
- [ ] 是否支持iOS辅助功能（VoiceOver、Switch Control等）？
- [ ] 是否使用了iOS标准间距和对齐方式？
- [ ] 是否考虑了不同语言的布局需求？

### 6.3 布局混乱修复检查项

- [ ] 元素是否按照4pt基础网格对齐？
- [ ] 间距是否使用标准值（8pt, 16pt, 24pt, 32pt）？
- [ ] 相关元素是否正确分组？
- [ ] 视觉层次是否清晰？
- [ ] 页面是否避免过度拥挤？
- [ ] 重要内容是否突出显示？
- [ ] 组件大小是否一致？
- [ ] 对齐方式是否一致？
- [ ] 内容密度是否适当？
- [ ] 导航结构是否清晰？
